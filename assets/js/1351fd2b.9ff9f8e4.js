"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[2731],{1128(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"t-lib/t-motor","title":"T_Motor API","description":"The T_Motor class provides advanced control over a single V5 motor with features including real-time PID control, slew limiting, load compensation, and anti-stall protection. All control operations are non-blocking, running in a background task.","source":"@site/docs/t-lib/t-motor.md","sourceDirName":"t-lib","slug":"/t-lib/t-motor","permalink":"/T_Lib/docs/t-lib/t-motor","draft":false,"unlisted":false,"editUrl":"https://github.com/Brody9185/T_Lib/tree/main/website/docs/t-lib/t-motor.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"T_MotorGroup API","permalink":"/T_Lib/docs/t-lib/t-motor-group"},"next":{"title":"Utilities API","permalink":"/T_Lib/docs/t-lib/utilities"}}');var r=t(4848),l=t(8453);const s={},i="T_Motor API",a={},d=[{value:"Constructor",id:"constructor",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Example",id:"example",level:3},{value:"Control Commands",id:"control-commands",level:2},{value:"setTargetRPM",id:"settargetrpm",level:3},{value:"setTargetPercent",id:"settargetpercent",level:3},{value:"stop",id:"stop",level:3},{value:"Example",id:"example-1",level:3},{value:"PID Control",id:"pid-control",level:2},{value:"Overview",id:"overview",level:3},{value:"setPIDEnabled",id:"setpidenabled",level:3},{value:"setDualConstants",id:"setdualconstants",level:3},{value:"setLowConstants",id:"setlowconstants",level:3},{value:"setHighConstants",id:"sethighconstants",level:3},{value:"setStartI",id:"setstarti",level:3},{value:"Getter Methods",id:"getter-methods",level:3},{value:"Example",id:"example-2",level:3},{value:"Slew Control",id:"slew-control",level:2},{value:"setSlewLimitEnabled",id:"setslewlimitenabled",level:3},{value:"setSlewRate",id:"setslewrate",level:3},{value:"Example",id:"example-3",level:3},{value:"Load Compensation",id:"load-compensation",level:2},{value:"setLoadCompensation (3 overloads)",id:"setloadcompensation-3-overloads",level:3},{value:"Parameters",id:"parameters-1",level:3},{value:"Getter Methods",id:"getter-methods-1",level:3},{value:"Example",id:"example-4",level:3},{value:"Minimum Torque (Anti-Stall)",id:"minimum-torque-anti-stall",level:2},{value:"setMinTorque (3 overloads)",id:"setmintorque-3-overloads",level:3},{value:"Parameters",id:"parameters-2",level:3},{value:"Getter Methods",id:"getter-methods-2",level:3},{value:"Example",id:"example-5",level:3},{value:"Sensor &amp; Status",id:"sensor--status",level:2},{value:"Speed and Position",id:"speed-and-position",level:3},{value:"Temperature and Voltage",id:"temperature-and-voltage",level:3},{value:"Status Checks",id:"status-checks",level:3},{value:"Example",id:"example-6",level:3},{value:"Configuration",id:"configuration",level:2},{value:"setReversed",id:"setreversed",level:3},{value:"setBrakeMode",id:"setbrakemode",level:3},{value:"resetPosition",id:"resetposition",level:3},{value:"getGearset",id:"getgearset",level:3},{value:"Example",id:"example-7",level:3},{value:"Complete Example",id:"complete-example",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"t_motor-api",children:"T_Motor API"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"T_Motor"})," class provides advanced control over a single V5 motor with features including real-time PID control, slew limiting, load compensation, and anti-stall protection. All control operations are non-blocking, running in a background task."]}),"\n",(0,r.jsx)(n.h2,{id:"constructor",children:"Constructor"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"T_Motor(int port, pros::v5::MotorGears gearset = util::Aliases::Blue, bool reversed = false);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"port"}),": Motor port number (1-21)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"gearset"}),": Motor gearset (Blue, Green, or Red) - defaults to Blue (600 RPM)","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"util::Aliases::Blue"}),": 600 RPM gearset"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"util::Aliases::Green"}),": 200 RPM gearset"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"util::Aliases::Red"}),": 100 RPM gearset"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"reversed"}),": Whether the motor direction is reversed (default: false)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"// Blue gear motor on port 3\r\nT_Lib::T_Motor motor(3);\r\n\r\n// Red gear motor on port 5, reversed direction\r\nT_Lib::T_Motor motor2(5, T_Lib::util::Aliases::Red, true);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"control-commands",children:"Control Commands"}),"\n",(0,r.jsx)(n.h3,{id:"settargetrpm",children:"setTargetRPM"}),"\n",(0,r.jsx)(n.p,{children:"Sets the target RPM for the motor using PID control."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setTargetRPM(double rpm);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"settargetpercent",children:"setTargetPercent"}),"\n",(0,r.jsx)(n.p,{children:"Sets the target power as a percentage (0-100%)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setTargetPercent(double percent);\r\nvoid setTargetPercent(T_Lib::util::units::Percentage percent);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stop",children:"stop"}),"\n",(0,r.jsx)(n.p,{children:"Stops the motor immediately."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void stop();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-1",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"motor.setTargetRPM(600);    // Set to 600 RPM\r\nmotor.setTargetPercent(75); // Set to 75% power\r\nmotor.stop();               // Stop the motor\n"})}),"\n",(0,r.jsx)(n.h2,{id:"pid-control",children:"PID Control"}),"\n",(0,r.jsx)(n.h3,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:'T_Motor uses a dual-speed PID controller to manage motor speed smoothly and accurately. The "low" speed constants control behavior at lower speeds, while "high" speed constants take over at higher speeds.'}),"\n",(0,r.jsx)(n.h3,{id:"setpidenabled",children:"setPIDEnabled"}),"\n",(0,r.jsx)(n.p,{children:"Enable or disable PID control."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setPIDEnabled(bool enabled);\r\nbool isPIDEnabled() const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setdualconstants",children:"setDualConstants"}),"\n",(0,r.jsx)(n.p,{children:"Set separate PID constants for low and high speed regimes."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setDualConstants(\r\n    double kvLow, double kpLow, \r\n    double kvHigh, double kpHigh\r\n);\r\n\r\nvoid setDualConstants(\r\n    double kvLow, double kpLow, double kiLow, double kdLow,\r\n    double kvHigh, double kpHigh, double kiHigh, double kdHigh\r\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setlowconstants",children:"setLowConstants"}),"\n",(0,r.jsx)(n.p,{children:"Set PID constants for the low-speed regime."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setLowConstants(double kvLow, double kpLow);\r\nvoid setLowConstants(double kvLow, double kpLow, double kiLow, double kdLow);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"sethighconstants",children:"setHighConstants"}),"\n",(0,r.jsx)(n.p,{children:"Set PID constants for the high-speed regime."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setHighConstants(double kvHigh, double kpHigh);\r\nvoid setHighConstants(double kvHigh, double kpHigh, double kiHigh, double kdHigh);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setstarti",children:"setStartI"}),"\n",(0,r.jsx)(n.p,{children:"Initialize the integral error term for smooth PID transitions."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setStartI(double startIntegral);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"getter-methods",children:"Getter Methods"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"double getLowKV() const;    double getLowKP() const;    double getLowKI() const;\r\ndouble getLowKD() const;\r\ndouble getHighKV() const;   double getHighKP() const;\r\ndouble getHighKI() const;   double getHighKD() const;\r\ndouble getStartI() const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-2",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"// Set simple proportional constants for low and high speeds\r\nmotor.setDualConstants(\r\n    0.05, 0.1,    // Low speed: kv, kp\r\n    0.05, 0.05    // High speed: kv, kp\r\n);\r\n\r\n// Set full PID constants with integral and derivative terms\r\nmotor.setDualConstants(\r\n    0.05, 0.1, 0.001, 0.05,    // Low speed: kv, kp, ki, kd\r\n    0.05, 0.05, 0.0, 0.02       // High speed: kv, kp, ki, kd\r\n);\r\n\r\n// Check if PID is enabled\r\nif (motor.isPIDEnabled()) {\r\n    // PID is active\r\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"slew-control",children:"Slew Control"}),"\n",(0,r.jsx)(n.p,{children:"Slew limiting restricts how quickly the motor can change speed, useful for preventing mechanical damage or reducing wheel slip."}),"\n",(0,r.jsx)(n.h3,{id:"setslewlimitenabled",children:"setSlewLimitEnabled"}),"\n",(0,r.jsx)(n.p,{children:"Enable or disable slew rate limiting."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setSlewLimitEnabled(bool enabled);\r\nbool isSlewLimitEnabled() const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setslewrate",children:"setSlewRate"}),"\n",(0,r.jsx)(n.p,{children:"Set the maximum RPM change per control loop iteration."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setSlewRate(double maxChange);\r\ndouble getSlewRate() const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-3",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"// Enable slew with a limit of 500 RPM change per iteration\r\nmotor.setSlewLimitEnabled(true);\r\nmotor.setSlewRate(500.0);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"load-compensation",children:"Load Compensation"}),"\n",(0,r.jsx)(n.p,{children:"Load compensation automatically boosts motor voltage when the motor is struggling under load, helping maintain target speed."}),"\n",(0,r.jsx)(n.h3,{id:"setloadcompensation-3-overloads",children:"setLoadCompensation (3 overloads)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setLoadCompensation(bool enabled);\r\nvoid setLoadCompensation(bool enabled, double kBoost);\r\nvoid setLoadCompensation(bool enabled, double kBoost, int threshold);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"parameters-1",children:"Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"enabled"}),": Enable or disable load compensation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"kBoost"}),": Boost multiplier (default: 4.5)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"threshold"}),": Current threshold in mA to trigger boost (default: 15 mA)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"getter-methods-1",children:"Getter Methods"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool isLoadCompEnabled() const;\r\ndouble getLoadKBoost() const;\r\nint getLoadThreshold() const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-4",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"// Enable basic load compensation with defaults\r\nmotor.setLoadCompensation(true);\r\n\r\n// Enable load compensation with custom boost\r\nmotor.setLoadCompensation(true, 5.0);\r\n\r\n// Enable with custom boost and current threshold\r\nmotor.setLoadCompensation(true, 6.0, 20);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"minimum-torque-anti-stall",children:"Minimum Torque (Anti-Stall)"}),"\n",(0,r.jsx)(n.p,{children:"Minimum torque ensures the motor applies a minimum voltage, preventing complete stalling under heavy loads."}),"\n",(0,r.jsx)(n.h3,{id:"setmintorque-3-overloads",children:"setMinTorque (3 overloads)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setMinTorque(bool enabled);\r\nvoid setMinTorque(bool enabled, int minMv);\r\nvoid setMinTorque(bool enabled, int minMv, int minLowMv);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"parameters-2",children:"Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"enabled"}),": Enable or disable minimum torque"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"minMv"}),": Minimum voltage for high speeds (default: 1200 mV)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"minLowMv"}),": Minimum voltage for low speeds (default: 600 mV)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"getter-methods-2",children:"Getter Methods"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool isMinTorqueEnabled() const;\r\nint getMinVoltageUser() const;\r\nint getMinVoltageLow() const;\r\nint getActiveMinVoltage() const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-5",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"// Enable with default values\r\nmotor.setMinTorque(true);\r\n\r\n// Custom minimum voltage\r\nmotor.setMinTorque(true, 1500);\r\n\r\n// Different minimums for low and high speed\r\nmotor.setMinTorque(true, 1500, 800);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"sensor--status",children:"Sensor & Status"}),"\n",(0,r.jsx)(n.h3,{id:"speed-and-position",children:"Speed and Position"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"double getRPM() const;            // Current motor RPM\r\ndouble getTargetRPM() const;      // Target RPM setpoint\r\ndouble getPosition() const;       // Current encoder position\n"})}),"\n",(0,r.jsx)(n.h3,{id:"temperature-and-voltage",children:"Temperature and Voltage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"double getTemperature() const;    // Motor temperature in Celsius\r\nint getVoltage() const;           // Current motor voltage in mV\r\nint getVoltageLimit() const;      // Global voltage limit in mV\n"})}),"\n",(0,r.jsx)(n.h3,{id:"status-checks",children:"Status Checks"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool isSpinning() const;          // True if motor is spinning at target\r\nbool isSpinningRaw() const;       // True if motor encoder is moving\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-6",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'printf("RPM: %f, Temp: %f C, Voltage: %d mV\\n", \r\n       motor.getRPM(), motor.getTemperature(), motor.getVoltage());\r\n\r\nif (motor.isSpinning()) {\r\n    printf("Motor is at target speed\\n");\r\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"setreversed",children:"setReversed"}),"\n",(0,r.jsx)(n.p,{children:"Reverse the motor direction."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setReversed(bool rev);\r\nbool isReversed() const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"setbrakemode",children:"setBrakeMode"}),"\n",(0,r.jsx)(n.p,{children:"Set the motor brake behavior."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void setBrakeMode(pros::v5::MotorBrake mode);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"resetposition",children:"resetPosition"}),"\n",(0,r.jsx)(n.p,{children:"Reset the encoder position to zero."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"void resetPosition();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"getgearset",children:"getGearset"}),"\n",(0,r.jsx)(n.p,{children:"Query the motor's gearset."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"pros::v5::MotorGears getGearset() const;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-7",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"motor.setReversed(true);                          // Reverse direction\r\nmotor.setBrakeMode(T_Lib::util::Aliases::Hold);  // Hold position on stop\r\nmotor.resetPosition();                            // Zero the encoder\n"})}),"\n",(0,r.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include "main.h"\r\n#include "T_Lib/api.hpp"\r\n\r\nvoid opcontrol() {\r\n    T_Lib::T_Motor motor(1, T_Lib::util::Aliases::Blue);\r\n    \r\n    // Configure PID and control\r\n    motor.setDualConstants(0.05, 0.1, 0.05, 0.05);\r\n    motor.setSlewLimitEnabled(true);\r\n    motor.setSlewRate(300.0);\r\n    motor.setLoadCompensation(true, 5.0, 15);\r\n    motor.setMinTorque(true, 1200, 600);\r\n    motor.setBrakeMode(T_Lib::util::Aliases::Hold);\r\n    \r\n    pros::Controller master(pros::E_CONTROLLER_MASTER);\r\n    \r\n    while (true) {\r\n        if (master.get_digital(pros::E_CONTROLLER_DIGITAL_A)) {\r\n            motor.setTargetRPM(600);\r\n        } else {\r\n            motor.stop();\r\n        }\r\n        \r\n        printf("RPM: %f, Temp: %f\\n", motor.getRPM(), motor.getTemperature());\r\n        pros::delay(20);\r\n    }\r\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,n,t){t.d(n,{R:()=>s,x:()=>i});var o=t(6540);const r={},l=o.createContext(r);function s(e){const n=o.useContext(l);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(l.Provider,{value:n},e.children)}}}]);